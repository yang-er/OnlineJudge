@model IEnumerable<JudgeHost>
@{
    ViewData["Title"] = "Dashboard";
}

<div class="container-fluid mt-4 mb-4 pl-4 pr-4">
    <h2>Judgehosts</h2>
    <h5 class="mb-3">Table for DOMjudge judgehosts</h5>
    <table class="mt-3 data-table table table-sm table-striped dataTable no-footer" role="grid" style="width:auto">
        <thead>
            <tr role="row">
                <th title="Hostname" style="min-width:10em" scope="col">hostname</th>
                <th title="Toggle activity" style="min-width:4em" scope="col">active</th>
                <th title="Last check time" style="min-width:5em" scope="col">last check</th>
                <!--<th title="Load in 5m, 2h, 2d" style="min-width:5em" scope="col">load</th>-->
            </tr>
        </thead>
        <tbody>
            @foreach (var host in Model)
            {
                var hjType = host.Active ? "1.0" : "0.3";
                var lastCheckAgo = DateTimeOffset.Now - host.PollTime;
                var statStr = lastCheckAgo.TotalSeconds < 30 ? "success" : lastCheckAgo.TotalSeconds < 120 ? "warning" : "danger";
                var statIcon = lastCheckAgo.TotalSeconds < 30 ? "success" : lastCheckAgo.TotalSeconds < 120 ? "error" : "failure";
                var todoIcon = host.Active ? "pause" : "play";
                //var load = loads.ContainsKey(host.ServerId) ? loads[host.ServerId] : default((int, int, int));
                <tr role="row" style="color:rgba(0,0,0,@hjType)">
                    <td><a style="color:rgba(0,0,0,@hjType)" asp-action="JudgeHost" asp-route-hostname="@host.ServerName">@host.ServerName</a></td>
                    <td><a class="btn btn-sm btn-outline-secondary pt-0 pb-0 pl-1 pr-1" asp-action="Toggle" asp-route-jh="@host.ServerName">@(host.Active ? "yes" : "no")</a></td>
                    <td class="bowtie" title="@host.PollTime"><i class="text-@statStr bowtie-status-@statIcon"></i> @Html.Timespan(lastCheckAgo)</td>
                    <!--<td>@@load.Item3, @@load.Item2, @@load.Item1</td>-->
                </tr>
            }
        </tbody>
    </table>
</div>
