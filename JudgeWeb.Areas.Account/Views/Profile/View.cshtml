@{
    ViewData["Title"] = "View User";
    User user = ViewBag.User;
    IEnumerable<SubmissionStatistics> stat = ViewBag.Stat;
}

<div style="background-color:#f2f2f2">
    <div class="container d-flex pt-4 pb-4 pl-4 pr-4">
        <div class="avatar">
            <img gravatar-email="@user.Email" class="rounded-circle" style="width:100%;max-width:8em" />
        </div>
        <div class="plan ml-4 mt-auto mb-auto">
            <h1>@(string.IsNullOrEmpty(user.NickName) ? user.UserName : user.NickName)</h1>
            <h5>@(user.Plan ?? "This guy is lazy, left nothing here.")</h5>
            <h6 class="text-muted">Registered on @((user.RegisterTime ?? DateTimeOffset.UnixEpoch).ToString("yyyy-MM-dd"))</h6>
        </div>
    </div>
</div>

<div class="container mt-4 mb-4 pl-4 pr-4">
    <div class="row">
        <div class="col-12 col-md-9">
            <h4>Statistics</h4>
            <table>
                <tr>
                    <th style="width:12em">Problems Submitted</th>
                    <td>@stat.Count()</td>
                </tr>
                <tr>
                    <th>Problems Solved</th>
                    <td>@stat.Count(s => s.AcceptedSubmission > 0)</td>
                </tr>
                <tr>
                    <th><a asp-area="Judge" asp-controller="Status" asp-action="List" asp-route-uid="@user.Id">Submissions</a></th>
                    <td>@stat.Sum(s => s.TotalSubmission)</td>
                </tr>
                <tr>
                    <th><a asp-area="Judge" asp-controller="Status" asp-action="List" asp-route-uid="@user.Id" asp-route-status="11">Accepted</a></th>
                    <td>@stat.Sum(s => s.AcceptedSubmission)</td>
                </tr>
            </table>

            <h4 class="mt-3">List of solved problems</h4>
            @foreach (var prob in stat.Where(p => p.AcceptedSubmission > 0))
            {
                <div class="mr-1 d-inline-block">
                    <a asp-area="Judge" asp-controller="Problem" asp-action="View" asp-route-pid="@prob.ProblemId">@prob.ProblemId</a>
                    <small class="text-danger">@prob.AcceptedSubmission/@prob.TotalSubmission</small>
                </div>
            }

            <h4 class="mt-3">List of unsolved problems</h4>
            @foreach (var prob in stat.Where(p => p.AcceptedSubmission == 0))
            {
                <a asp-area="Judge" asp-controller="Problem" asp-action="View" asp-route-pid="@prob.ProblemId">@prob.ProblemId</a>
                <small class="text-danger mr-1">@prob.AcceptedSubmission/@prob.TotalSubmission</small>
            }
        </div>
    </div>
</div>
